digraph RedoGameModel {
    Goal [label="Redo game model to support\n1) more simultaneous games\n2) less downtime between deploys\n3) make DB faster to back up and query";
    shape=oval, peripheries=2, style=bold];

    // Define a reusable style for "checked nodes"  ✅
    node [shape=box, color=gray, fontcolor=gray, style=dashed];
    DBGet [label="Rewrite DB Get to use sqlc ✅"];
    AddOtherTables [label="Add many2many and turns tables ✅"];
    SQLCDBStore [label="Rewrite DB store to use sqlc ✅"];
    SQLCOtherFuncs [label="Rewrite all others to use sqlc ✅"];
    ConsolidateRequestColumns [label="Consolidate request columns ✅"];

    // Reset to default for other uncompleted nodes
    node [shape=box, color=black, fontcolor=black, style=solid];

    MoreSimultaneousGames [label="Allow for more simultaneous games than cache limit"];
    LessDowntimeBetweenDeploys [label="Allow for less downtime between deploys"];
    MakeDBFaster [label="Make DB faster to query"];

    ImproveOtherTables [label="Improve many2many tables\nAdd indexes, pastgames table"];
    OnlyUseOtherTables [label="Only use new tables"];
    MigrateToNewTables [label="Migrate to new tables"];
    UseOtherTables [label="Transparently use new tables"];
    RemoveGameCache [label="Remove game cache"];
    EfficientTable [label="Make game DB model more efficient"];

    FixGameDocumentBugs [label="Fix and test GameDocument bugs"];

    DBSetSplit [label="Split DB Set into separate functions\nthat set specific attributes of game"];

    ReplaceQuickData [label="Replace QuickData with JOINs"];

    ClearLargeFields [label="Clear large fields in games table"];
    ImplementS3Archival [label="Implement S3 archival of old partitions"];
    // Arrows
    Goal -> MoreSimultaneousGames;
    Goal -> LessDowntimeBetweenDeploys;
    Goal -> MakeDBFaster;
    Goal -> ImplementS3Archival;

    MoreSimultaneousGames -> RemoveGameCache;
    LessDowntimeBetweenDeploys -> RemoveGameCache;
    MakeDBFaster -> EfficientTable;

    RemoveGameCache -> EfficientTable;
    OnlyUseOtherTables -> ReplaceQuickData;
    ReplaceQuickData -> MigrateToNewTables;

    MigrateToNewTables -> UseOtherTables;
    ImproveOtherTables -> AddOtherTables;
    EfficientTable -> SQLCDBStore;
    EfficientTable -> DBSetSplit;
    DBSetSplit -> SQLCOtherFuncs;
    UseOtherTables -> ImproveOtherTables;
    UseOtherTables -> FixGameDocumentBugs;
    SQLCDBStore -> DBGet;
    SQLCDBStore -> SQLCOtherFuncs;
    ConsolidateRequestColumns -> SQLCOtherFuncs;
    EfficientTable -> ConsolidateRequestColumns;
    MakeDBFaster -> ClearLargeFields;
    ClearLargeFields -> OnlyUseOtherTables;
    ImplementS3Archival -> ClearLargeFields;

}

